<!DOCTYPE html>
<html>
<head>
  <title>Modificar datos.txt</title>
  <script>
    function inicializarArchivo() {
      if (!localStorage.getItem('datos')) {
        localStorage.setItem('datos', 'teta'); // Crear contenido inicial si no existe
      }
    }

    function leerYActualizarArchivo() {
      navigator.geolocation.getCurrentPosition(function(position) {
        const fechaHora = new Date().toLocaleString();
        const latitud = position.coords.latitude;
        const longitud = position.coords.longitude;
        const contenidoAnterior = localStorage.getItem('datos');
        const nuevoContenido = `${contenidoAnterior}\nFecha/Hora: ${fechaHora}, Teta: teta, Latitud: ${latitud}, Longitud: ${longitud}`;
        
        localStorage.setItem('datos', nuevoContenido); // Guardar en localStorage
        
        // Descargar el archivo automáticamente después de actualizarlo
        descargarArchivo();
      }, function(error) {
        console.error('Error al obtener la ubicación: ', error);
        alert('No se pudo obtener la ubicación. Por favor, intente nuevamente.');
      });
    }

    function descargarArchivo() {
      let contenido = localStorage.getItem('datos');
      const blob = new Blob([contenido], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);

      // Crear un enlace invisible para descargar el archivo
      const a = document.createElement('a');
      a.href = url;
      a.download = 'datos.txt'; // Nombre del archivo a crear/actualizar
      document.body.appendChild(a);
      a.style.display = 'none';
      a.click();

      document.body.removeChild(a);
      window.URL.revokeObjectURL(url);
    }

    window.onload = function() {
      inicializarArchivo();
      leerYActualizarArchivo(); // Actualizar y descargar el archivo al cargar la página
    };
  </script>
</head>
<body>
  <h1>Modificar datos.txt</h1>
  <p>Los datos se actualizarán automáticamente y se descargará el archivo actualizado.</p>
</body>
</html>
